<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Personal Details Form</title>
<link rel="stylesheet" href="details-style.css">
</head>
<body>
<div class="card">
<h2>Personal Details</h2>

<!-- Profile Picture Section -->
<div class="profile-picture-container">
  <label for="profilePicture">Profile Picture:</label><br>
  <button id="openCamera">Open Camera</button>
  <button id="uploadGallery">Upload from Gallery</button>
  <input type="file" id="profilePicture" name="profilePicture" accept="image/*" style="display: none;">
  <video id="cameraStream" autoplay style="display: none;"></video>
  <canvas id="canvas" style="display: none;"></canvas>
  <button id="capture" style="display: none;">Capture</button>
  <img id="previewImage" src="#" alt="Profile Preview" style="display: none;">
</div>

<form action="submit-your-details" method="post">
  <label for="collegeName">College Name:</label><br>
  <input type="text" id="collegeName" name="collegeName" required><br><br>
  
  <label for="course">Course:</label><br>
  <input type="text" id="course" name="course" required><br><br>
  
  <label for="year">Year:</label><br>
  <div class="dropdown">
    <select id="year" name="year" required>
      <option value="">Select Year</option>
      <option value="first">First</option>
      <option value="second">Second</option>
      <option value="third">Third</option>
      <option value="fourth">Fourth</option>
    </select>
  </div><br><br>
  
  <label for="location">Location:</label><br>
  <input type="text" id="location" name="location" required><br><br>
  
  <label for="githubLink">GitHub Profile Link:</label><br>
  <input type="url" id="githubLink" name="githubLink" required><br><br>
  
  <label for="linkedinLink">LinkedIn Profile Link:</label><br>
  <input type="url" id="linkedinLink" name="linkedinLink" required ><br><br>
  
  <label for="techStack">Tech Stack Abilities:</label><br>
  <div class="techstack-dropdown">
    <select id="techStackDropdown" onchange="selectTechStack(this.value)">
      <option value="">Select Tech Stack</option>
      <option value="JavaScript">JavaScript</option>
      <option value="Python">Python</option>
      <option value="Java">Java</option>
      <option value="HTML">HTML</option>
      <option value="CSS">CSS</option>
      <option value="Ruby">Ruby</option>
      <option value="C">C</option>
      <option value="C++">C++</option>
      <option value="C#">C#</option>
      <option value="R">R</option>
      <option value="Swift">Swift</option>
      <option value="Kotlin">Kotlin</option>
      <option value="Golang">Golang</option>
      <option value="PHP">PHP</option>
      <option value="Crystal">Crystal</option>
      <option value="Dart">Dart</option>
      <option value="Elixir">Elixir</option>
      <option value="Vite">Vite</option>
      <option value="React">React</option>
      <option value="Flask">Flask</option>
      <option value="Tensor Flow">Tensor Flow</option>
      <option value="Others">Others</option>
      <!-- Add other programming languages as needed -->
    </select>
  </div><br><br>
  
  <div id="techStackContainer" class="badge-container"></div>
  
  <input type="submit" value="Submit">
</form>
</div>
<script>
var badgeCount = 0;
var localMediaStream = null; // Added a variable to hold the stream globally

function selectTechStack(tech) {
  // Tech stack selection code
}

// Open Camera functionality
document.getElementById('openCamera').addEventListener('click', function() {
  var video = document.getElementById('cameraStream');
  var captureButton = document.getElementById('capture');
  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(function(stream) {
        localMediaStream = stream; // Assign the stream to the global variable
        video.srcObject = stream;
        video.style.display = 'block';
        captureButton.style.display = 'block';
      })
      .catch(function(error) {
        console.log("Something went wrong accessing the camera!");
      });
  }
});

// Capture functionality
document.getElementById('capture').addEventListener('click', function() {
  var canvas = document.getElementById('canvas');
  var video = document.getElementById('cameraStream');
  if (localMediaStream) {
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext('2d').drawImage(video, 0, 0);
    // Convert canvas to image
    var dataUrl = canvas.toDataURL('image/png');
    document.getElementById('previewImage').src = dataUrl;
    document.getElementById('previewImage').style.display = 'block';
    video.style.display = 'none';
    this.style.display = 'none';
    localMediaStream.getTracks().forEach(function(track) { // Stop each track on the stream
      track.stop();
    });
    localMediaStream = null; // Clear the global stream variable
  }
});

// Upload from Gallery functionality
document.getElementById('uploadGallery').addEventListener('click', function() {
  document.getElementById('profilePicture').click();
});

document.getElementById('profilePicture').addEventListener('change', function(event) {
  var reader = new FileReader();
  reader.onload = function(e) {
    document.getElementById('previewImage').src = e.target.result;
    document.getElementById('previewImage').style.display = 'block';
    document.getElementById('cameraStream').style.display = 'none'; // Hide the camera stream
    captureButton.style.display = 'none'; // Hide the capture button
    if (localMediaStream) {
      localMediaStream.getTracks().forEach(function(track) { // Stop each track on the stream
        track.stop();
      });
      localMediaStream = null; // Clear the global stream variable
    }
  };
  reader.readAsDataURL(event.target.files[0]);
});
</script>

</body>
</html>
